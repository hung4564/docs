import{p as g,d as _,c as w,o as B,F as U,j as i,e as T,a as y,t as b,k as F,_ as R,C as A,G as m,ah as I,w as L}from"./chunks/framework.ArdWB6UD.js";const C=s=>{if(typeof s=="string"){if(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("ftp://"))return"url";if(s.startsWith("data:"))return"base64"}else{if(s instanceof Blob||s instanceof File)return"blob";if(s instanceof ArrayBuffer||s instanceof Uint8Array)return"buffer"}throw new Error("Không thể xác định loại dữ liệu để tải")},x=s=>{var n;const o=(n=s.split(".").pop())==null?void 0:n.toLowerCase();return{pdf:"application/pdf",txt:"text/plain",csv:"text/csv",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",html:"text/html"}[o||""]||"application/octet-stream"};function P(){const s=g("idle"),o=g(null),e=()=>{s.value="idle",o.value=null},n=async(a,p,l,d)=>{e();try{s.value="downloading";const k=l||C(a),u=p||"download",c=d||x(u);let r;switch(k){case"url":{const t=await fetch(a);if(!t.ok)throw new Error(`Fetch failed: ${t.status} ${t.statusText}`);r=await t.blob();break}case"base64":{const t=a,E=atob(t.split(",")[1]||t),D=new ArrayBuffer(E.length),v=new Uint8Array(D);for(let f=0;f<E.length;f++)v[f]=E.charCodeAt(f);r=new Blob([D],{type:c});break}case"blob":{r=a;break}case"buffer":{if(a instanceof ArrayBuffer)r=new Blob([a],{type:c});else if(a instanceof Uint8Array)r=new Blob([a.buffer],{type:c});else throw new Error("Không thể chuyển buffer thành Blob");break}default:throw new Error("Loại dữ liệu không hợp lệ")}h(r,u),s.value="success"}catch(k){s.value="error",o.value=k.message||"Lỗi không xác định"}},h=(a,p)=>{const l=document.createElement("a"),d=URL.createObjectURL(a);l.href=d,l.download=p,l.click(),URL.revokeObjectURL(d)};return{status:s,error:o,downloadFile:n,detectType:C,guessMimeType:x}}const S={class:"status"},j={key:0,class:"error"},V=_({__name:"demo",setup(s){const{status:o,error:e,downloadFile:n}=P(),h=g("data:text/plain;base64,SGVsbG8sIHdvcmxkIQ=="),a=new Blob(["Blob content example!"],{type:"text/plain"}),p=new TextEncoder().encode("Binary text!"),l=g(""),d=()=>{l.value="url",n("https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf","example.pdf")},k=()=>{l.value="base64",n(h.value,"hello.txt")},u=()=>{l.value="blob",n(a,"blob-example.txt")},c=()=>{l.value="buffer",n(p,"binary.txt")};return(r,t)=>(B(),w(U,null,[i("div",{class:"actions"},[i("button",{onClick:d},"Download from URL"),i("button",{onClick:k},"Download from Base64"),i("button",{onClick:u},"Download from Blob"),i("button",{onClick:c},"Download from Buffer")]),i("div",S,[i("p",null,[t[0]||(t[0]=i("b",null,"Status:",-1)),y(" "+b(F(o)),1)]),i("p",null,[t[1]||(t[1]=i("b",null,"Source:",-1)),y(" "+b(l.value),1)]),F(e)?(B(),w("p",j,"❌ Error: "+b(F(e)),1)):T("",!0)])],64))}}),q=R(V,[["__scopeId","data-v-b929e3f6"]]),O=JSON.parse('{"title":"useDownloadFile","description":"","frontmatter":{"category":"Browser"},"headers":[],"relativePath":"shared-file/useDownloadFile/index.md","filePath":"share/file/useDownloadFile/index.md","lastUpdated":1745326309000}'),N={name:"shared-file/useDownloadFile/index.md"},G=Object.assign(N,{setup(s){return(o,e)=>{const n=A("FunctionInfo"),h=A("DemoContainer");return B(),w("div",null,[e[0]||(e[0]=i("h1",{id:"usedownloadfile",tabindex:"-1"},[y("useDownloadFile "),i("a",{class:"header-anchor",href:"#usedownloadfile","aria-label":'Permalink to "useDownloadFile"'},"​")],-1)),m(n,{frontmatter:o.$frontmatter,package:"Share - File",fn:"useDownloadFile"},null,8,["frontmatter"]),e[1]||(e[1]=i("p",null,"Easily download files from a URL, Blob, Base64, or Buffer (ArrayBuffer/Uint8Array). Provides download status tracking and error handling.",-1)),e[2]||(e[2]=i("h2",{id:"demo",tabindex:"-1"},[y("Demo "),i("a",{class:"header-anchor",href:"#demo","aria-label":'Permalink to "Demo"'},"​")],-1)),m(h,null,{default:L(()=>[m(q)]),_:1}),e[3]||(e[3]=I(`<h2 id="return-values" tabindex="-1">Return Values <a class="header-anchor" href="#return-values" aria-label="Permalink to &quot;Return Values&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>status</code></td><td>Current download status (<code>&#39;idle&#39;</code>, <code>&#39;downloading&#39;</code>, <code>&#39;success&#39;</code>, <code>&#39;error&#39;</code>)</td></tr><tr><td><code>error</code></td><td>Error message if the download fails (or <code>null</code> if no error)</td></tr><tr><td><code>downloadFile</code></td><td>Unified function to download a file from URL, Blob, base64, or binary buffer</td></tr></tbody></table><h2 id="input-parameters-for-downloadfile" tabindex="-1">Input Parameters for <code>downloadFile</code> <a class="header-anchor" href="#input-parameters-for-downloadfile" aria-label="Permalink to &quot;Input Parameters for \`downloadFile\`&quot;">​</a></h2><ul><li><p><code>data</code> (string | Blob | ArrayBuffer | Uint8Array)</p><ul><li>Required. The content to be downloaded. It can be: <ul><li>A URL (string)</li><li>A base64 string (with or without data URI prefix)</li><li>A <code>Blob</code> object</li><li>An <code>ArrayBuffer</code> or <code>Uint8Array</code> for binary data</li></ul></li></ul></li><li><p><code>filename</code> (string)</p><ul><li>Optional. The name of the file to save. Defaults to <code>&#39;download&#39;</code> if not provided.</li></ul></li><li><p><code>mimeType</code> (string)</p><ul><li>Optional. The MIME type of the file content.</li><li>If not provided, it will be guessed based on the file extension in <code>filename</code>, or default to <code>&#39;application/octet-stream&#39;</code>.</li></ul></li></ul><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useDownloadFile } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@hungpvq/shared-file&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useDownloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Download from URL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://example.com/file.pdf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example.pdf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Download from base64</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> base64</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;data:text/plain;base64,SGVsbG8=&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base64, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;greeting.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Download from Blob</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> blob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], { type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;text/plain&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(blob, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Download from ArrayBuffer / Uint8Array</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TextEncoder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">encode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;binary data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> downloadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buffer, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data.bin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">​</a></h2><ul><li>Automatically detects input type (URL, base64, Blob, Buffer).</li><li>Automatically guesses MIME type from filename if not provided.</li><li>Supports binary data with <code>ArrayBuffer</code> and <code>Uint8Array</code>.</li></ul>`,8))])}}});export{O as __pageData,G as default};
